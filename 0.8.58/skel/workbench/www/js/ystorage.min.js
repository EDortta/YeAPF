/* YeAPF 0.8.58-87 built on 2017-06-27 12:36 (-3 DST) Copyright (C) 2004-2017 Esteban Daniel Dortta - dortta@yahoo.com */
(function(){window.ystorage||(window.ystorage=function(){var g=[],h={},b={};Object.defineProperty(h,"getItem",{value:function(a){return a?b[a]:null},writable:!1,configurable:!1,enumerable:!1});Object.defineProperty(h,"key",{value:function(a){return g[a]},writable:!1,configurable:!1,enumerable:!1});Object.defineProperty(h,"setItem",{value:function(a,b){a&&(document.cookie=escape(a)+"="+escape(b)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")},writable:!1,configurable:!1,enumerable:!1});Object.defineProperty(h,
"length",{get:function(){return g.length},configurable:!1,enumerable:!1});Object.defineProperty(h,"removeItem",{value:function(a){a&&(document.cookie=escape(a)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")},writable:!1,configurable:!1,enumerable:!1});b.get=function(){var a,b;for(b in h)a=g.indexOf(b),-1===a?h.setItem(b,h[b]):g.splice(a,1),delete h[b];for(;0<g.length;g.splice(0,1))h.removeItem(g[0]);for(var c=0,e=document.cookie.split(/\s*;\s*/);c<e.length;c++)a=e[c].split(/\s*=\s*/),1<a.length&&
(h[b=unescape(a[0])]=unescape(a[1]),g.push(b));return h};b.configurable=!1;b.enumerable=!0;return b}());window.ySingleDb||(console.log("Creating ySingleDb ... "),window.ySingleDb=function(g,h){var b={_list:null,toBinArray:function(a){for(var b=(a||"").length,c=new Uint8Array(b),e=0;e<b;e++)c[e]=a.charCodeAt(e);return c},toBinString:function(a){a=new Uint8Array(a);for(var b=[],c=0;65535*c<a.length;c++)b.push(String.fromCharCode.apply(null,a.subarray(65535*c,65535*(c+1))));return b.join("")},setItem:function(a,
d,c){var e,f,k;a=String(a);d._id=d._id||generateUUID();d._ts_update=(new Date).getTime()/1E3;if(isArray(c)&&(k=b.getItem(a),!isEmpty(k)))for(e=0;e<c.length;e++)"undefined"!==typeof k[c[e]]&&(d[c[e]]=k[c[e]]);if(d._linked){for(e=0;e<d._linked.length;e++)delete d[d._linked[e]];delete d._linked}for(f in d)d.hasOwnProperty(f)&&"_"!=f.substr(0,1)&&isArray(d[f])&&(d[f]=JSON.stringify(d[f]));localStorage.setItem(b._dbTag_+"_item_"+a,JSON.stringify(d));-1==b._list.indexOf(a)&&(b._list[b._list.length]=a,localStorage.setItem(b._dbTag_+
"_list",JSON.stringify(b._list)))},setBinItem:function(a,d,c){b.setItem(a,b.toBinString(d),c)},getItem:function(a){a=String(a);a=localStorage.getItem(b._dbTag_+"_item_"+a);a=JSON.parse(a||"{}");if(!isEmpty(a)&&isArray(b._siblingDB)){var d;a._linked=[];for(var c=0;c<b._siblingDB.length;c++){d=b._siblingDB[c].db.getItem(a[b._siblingDB[c].linkage]);for(var e in d)a._linked=[],d.hasOwnProperty(e)&&"undefined"==typeof a[e]&&(a[e]=d[e],a._linked.push(e))}}return a},getBinItem:function(a){return b.toBinArray(b.getItem(a))},
getList:function(){return b._list||[]},linkTo:function(a,d){a&&a.getItem?"undefined"==typeof d&&(a=null):a=d=null;if(a){var c={db:a,linkage:d||null};b._siblingDB=b._siblingDB||[];b._siblingDB.push(c)}},filter:function(a,d,c,e){if("function"==typeof a){c=c||!0;var f=!1,k;!0===c?f=!0:(k=yLexObj(c),k.parse());var l=b.getList(),m,n;for(c=0;c<l.length;c++)if(m=b.getItem(l[c]),n=f||k.solve(m))a(m),e&&(c=l.length+1)}"function"==typeof d&&d()},each:function(a,d,c,e){var f=function(a,b){b=String(b).split(" ");
var c=!0,d,e;for(d in b)e=trim(b[d]),c=isNumber(e)&&isNumber(a)?c&&parseFloat(e)===parseFloat(a):c&&0<=(""+a).toUpperCase().indexOf(e.toUpperCase());return c},k,l=b.getList(),m,n;for(k=0;k<l.length;k++)if("function"==typeof a){m=b.getItem(l[k]);n="undefined"==typeof c;if(!n)if("string"==typeof c)n=f(m[b.cfg.keyName],c);else if("object"==typeof c){n=!0;for(var g in c)c.hasOwnProperty(g)&&(n="undefined"!==typeof m[g]?n&&f(m[g],c[g]):!1)}n&&(a(m),e&&(k=l.length+1))}"function"==typeof d&&d()},insertData:function(a,
d){for(var c in a)a.hasOwnProperty(c)&&b.setItem(a[c][b._keyName_],a[c],d)},count:function(a){var d=0;b.each(function(){d++},null,a);return d},extractData:function(a,d){var c=[];b.each(function(a){c[c.length]=a},function(){a(c)},d)},fillList:function(a,d,c,e){d=d||"id";c&&b.cleanList();for(c=0;c<a.length;c++)a[c][d]&&b.setItem(a[c][d],a,e)},removeItem:function(a,d){if(("undefined"!==typeof d?d:1)&&"function"==typeof b.onremove)b.onremove(b.getItem(a));localStorage.removeItem(b._dbTag_+"_item_"+a);
var c=b._list.indexOf(String(a));-1<c&&(b._list.splice(c,1),localStorage.setItem(b._dbTag_+"_list",JSON.stringify(b._list)))},removeItems:function(a,d){d="undefined"!==typeof d?d:!0;b.extractData(function(a){for(var e in a)a.hasOwnProperty(e)&&b.removeItem(a[e][b._keyName_],d)},a)},eliminateItem:function(a){b.removeItem(a,!1)},eliminateItems:function(a){b.removeItems(a,!1)},cleanList:function(a){a="undefined"!==typeof a?a:!0;var d=[],c=0,e;for(e in b._list)d[c++]=b._list[e];for(c=0;c<d.length;c++)b.removeItem(d[c],
a)},blankList:function(){b.cleanList(!1)},init:function(a,d){b._dbTag_=a;b._keyName_=d||"_id";console.log("ystorage: creating "+a);b._list=localStorage.getItem(b._dbTag_+"_list");"string"==typeof b._list&&(b._list=JSON&&JSON.parse(b._list)||[]);b._list=b._list||[];return b}};return b.init(g,h)},console.log("ystorage ready!"));window.yIndexedDB||(window.indexedDB||(window.indexedDB=window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),window.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||
window.msIDBTransaction,window.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange,window.yIndexedDB=function(g,h,b){var a={_newTransaction:function(b,c,e){e=e||function(a){0!==a&&k&&(k=!1,"function"==typeof c&&c(520,a,[{}]))};b=a._db.transaction([a._dbTag_],"readwrite");var f,k=!0;b.oncomplete=function(){f=0;"function"==typeof e&&e(f)};b.onerror=function(){f=1;"function"==typeof e&&e(f)};return b.objectStore(a._dbTag_)},count:function(b){var c=a._newTransaction("readonly").count();
c.onsuccess=function(){"function"==typeof b&&b(200,0,[c.result])}},setItem:function(b,c,e){b=!1;if(3==a.status){c._id=c._id||generateUUID();c._ts_update=(new Date).getTime()/1E3;var f=a._newTransaction("readwrite",e).put(c);f.onsuccess=function(){"function"==typeof e&&e(200,0,[f.result])};b=!0}return b},getItem:function(b,c){var e=!1;if(3==a.status){var f=a._newTransaction("readonly",c).get(b);f.onsuccess=function(){"function"==typeof c&&c(200,0,[f.result])};e=!0}return e},insertData:function(b,c,
e){c=!1;if(3==a.status){c=a._newTransaction("readwrite",e);for(var f=0,k=0,l=0;l<b.length;l++){var g=b[l];g._id=g._id||generateUUID();g._ts_update=(new Date).getTime()/1E3;g=c.put(g);g.onsuccess=function(a){a=a.target;f++;f+k>=b.length&&"function"==typeof e&&e(200,{errorCount:k},[a.result])};g.onerror=function(a){k++;f+k>=b.length&&"function"==typeof e&&e(200,{errorCount:k},[{}])}}c=!0}return c},filter:function(b,c,e,f){if(3==a.status){var g=function(b){0===b&&"function"==typeof c&&c()};if("function"==
typeof b){e=e||!0;var l=!1;if(!0===e)l=!0;else{var h=yLexObj(e);h.parse()}e=a._newTransaction("readonly",void 0,g).openCursor();e.onsuccess=function(a){var c=a.target.result;c&&((a=l||h.solve(c.value))&&b(c.value),f||c.continue())};e.onerror=function(){}}else g(0)}},slice:function(b,c,e,f,g){if(3==a.status){var l=function(b){0===b&&"function"==typeof c&&c()};if("function"==typeof b){var l=a._newTransaction("readonly",void 0,l).openCursor(),h=0;e=Math.max(0,e);l.onsuccess=function(a){if(a=a.target.result)h<
e?(h=e,console.log("Advancing to {0}".format(e)),0<e&&a.advance(e)):(h++,h<=f&&("function"===typeof b&&b(a.value),g||h<f&&a.continue()))};l.onerror=function(){}}else l(0)}},removeItem:function(b,c){var e=!1;if(3==a.status){var f=a._newTransaction("readonly",c).delete(b);f.onsuccess=function(){"function"==typeof c&&c(200,0,f.result)};e=!0}return e},onDBRequestError:function(b){a._status=-1;console.error("yIndexedDB error trying to open '{0}'".format(g))},onDBRequestSuccess:function(d){a._status=3;
a._db=d.target.result;"function"==typeof b&&b()},onDBUpgradeNeeded:function(b){a._status=2;a._db=b.target.result;a._objectStore=a._db.createObjectStore(a._dbTag_,{keyPath:a._keyName_[0]});for(b=1;b<a._keyName_.length;b++)a._objectStore.createIndex(a._keyName_[b]+"_ndx",a._keyName_[b],{unique:!1});a._status=3},init:function(b,c){a._dbTag_=b;c=c||"_id";if(!isArray(c)){var e=0<=c.indexOf(",")?",":";";c=c.split(e)}a._keyName_=c.slice();0===a._keyName_.length&&(a._keyName_[0]="_id");a._status=0;Object.defineProperty(a,
"status",{get:function(){return a._status},configurable:!1,enumerable:!1});window.indexedDB&&(a._status=1,a._DBOpenRequest=window.indexedDB.open(b,1),a._DBOpenRequest.onerror=a.onDBRequestError,a._DBOpenRequest.onsuccess=a.onDBRequestSuccess,a._DBOpenRequest.onupgradeneeded=a.onDBUpgradeNeeded);return a}};return a.init(g,h)});window.yServerWatcherObj||(window.yServerWatcherObj=function(g){var h={serverReady:function(b,a){var d=(new Date).getTime();ycomm.crave("sync","ping",null,function(c,e,f){200==
c?0<parseInt(f.pong||0)&&(c=(new Date).getTime()-d,console.log("Server ready..."),console.log("Wasted time: {0}ms".format(c)),ycomm.wd_interval=4*c,"function"==typeof b&&b()):"function"==typeof a&&a(c,e)})},init:function(){ycomm.setDataLocation(g);h.serverReady(function(){console.log("Server ready!")});return h}};return h.init()});window.yInfoObj||(window.yInfoObj=function(g,h){var b={};if("object"==typeof g&&"string"==typeof g.dbName)return b.cfg={db:ySingleDb(g.dbName,g.keyName),garbage:ySingleDb(g.dbName+
"_garbage",g.keyName),dbName:g.dbName,keyName:g.keyName,dataModified:0,onrecordcount:null,onprogress:null,oncomplete:null},b.onremove=function(a){a._ts_deletion=(new Date).getTime()/1E3;b.cfg.garbage.setItem(a._id,a);b.cfg.dataModified++},b.isbusy=function(){return b.busy},b.getItem=function(a){return b.cfg.db.getItem(a)},b.setItem=function(a,d,c){b.cfg.dataModified++;return b.cfg.db.setItem(a,d,c)},b.removeItem=function(a){return b.cfg.db.removeItem(a)},b.removeItems=function(a){return b.cfg.db.removeItems(a)},
b.eliminateItem=function(a){return b.cfg.db.eliminateItem(a)},b.eliminateItems=function(a){return b.cfg.db.eliminateItems(a)},b.cleanList=function(){return b.cfg.db.cleanList()},b.blankList=function(){return b.cfg.db.blankList()},b.linkTo=function(a,d){return b.cfg.db.linkTo(a,d)},b.filter=function(a,d,c,e){return b.cfg.db.filter(a,d,c,e)},b.each=function(a,d,c,e){return b.cfg.db.each(a,d,c,e)},b.paint=b.each,b.count=function(a){return b.cfg.db.count(a)},b.extractData=function(a,d){var c=[];b.each(function(b){c[c.length]=
b},function(){a(c)},d)},b.insertData=function(a,d){return b.cfg.db.insertData(a,d)},b.cleanCondition=function(){b.cfg.condition={}},b.setCondition=function(a){if("string"==typeof a){a=a.match(/\S+/g);var d,c="";for(d=0;d<a.length;d++)isNumber(a[d])||isOperator(a[d])||(a[d]="%("+a[d]+")"),c+=a[d]+" ";b.cfg.condition={_statement_:c}}else b.cfg.condition=a||{}},b.retrieveFromServer=function(a,d,c){var e=function(){var a={xq_start:b.cfg.xq_start,xq_collectionName:b.cfg.dbName},c=(new Date).getTime();
mergeObject(b.cfg.condition,a);ycomm.crave("sync","getDocumentInSequence",a,function(a,d,f){if(0<f.length){b.cfg.interleave.adjustRestTime(c);for(a=0;a<f.length;a++)if(b.setItem(f[a][b.cfg.keyName],f[a]),"function"==typeof b.cfg.onprogress)b.cfg.onprogress(b.cfg.dbName,f[a],b.cfg.xq_start+a);b.cfg.xq_start+=f.length;setTimeout(e,b.cfg.interleave.restTime)}else{if("function"==typeof b.cfg.oncomplete)b.cfg.oncomplete(b.cfg.dbName);b.busy=!1}})};if(b.busy)return console.warn("yInfoObj busy"),!1;b.busy=
!0;b.cfg.onrecordcount=a||null;b.cfg.oncomplete=d||null;b.cfg.onprogress=c||null;b.server.serverReady(function(){ycomm.crave("sync","getRecordCount",b.cfg.condition,function(a,c,d){d=d||[];d[0]=d[0]||{};if("function"==typeof b.cfg.onrecordcount)b.cfg.onrecordcount(b.cfg.dbName,parseInt(d[0].CC||0));b.cfg.xq_start=0;e()})},function(b,a){console.log("Erro {0} ao tentar acessar o servidor: {1}".format(b,a.message))});return!0},b.templatedData=function(a){var d;if(b.cfg.dataTemplateEmpty)d=a;else{d={};
for(var c in b.cfg.dataTemplate)b.cfg.dataTemplate.hasOwnProperty(c)&&(d[c]=a[c])}return d},b.sendToServer=function(a,d){if(b.busy)return console.warn("yInfoObj busy"),!1;b.busy=!0;b.cfg.onrecordcount=null;b.cfg.oncomplete=a||null;b.cfg.onprogress=d||null;var c=0;b.server.serverReady(function(){b.each(function(a){var d=b.templatedData(a);a._ts_upload=(new Date(a)).getTime()/1E3;mergeObject(b.cfg.condition,d);ycomm.crave("sync","setDocument",d,function(a,d,e){if(200==a&&"function"==typeof b.cfg.onprogress)b.cfg.onprogress(b.cfg.dbName,
e[0],++c)})},function(){if("function"==typeof b.cfg.oncomplete)b.cfg.oncomplete(b.cfg.dbName);b.busy=!1},b.cfg.condition)},function(a,b){console.log("Erro {0} ao tentar acessar o servidor: {1}".format(a,b.message))});return!0},b.init=function(a){b.cfg.interleave=yRestTimeControl(500);b.cfg.dataTemplateEmpty="undefined"===typeof a?!0:!1;b.cfg.dataTemplate=a||{};b.cfg.db.onremove=b.onremove;b.server=yServerWatcherObj(restServer);b.cleanCondition();return b},b.init(g.dataTemplate);console.error("Since 0.8.55 the parameters or yInfoObj() has changed to (aDBSpec: {}, aServerSpec: {})");
alert("Since 0.8.55 the parameters or yInfoObj() has changed to (aDBSpec: {}, aServerSpec: {})")})})();
