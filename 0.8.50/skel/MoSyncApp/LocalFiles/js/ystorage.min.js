/* YeAPF 0.8.50-39 built on 2016-09-20 16:54 (-3 DST) Copyright (C) 2004-2016 Esteban Daniel Dortta - dortta@yahoo.com */
window.ystorage||Object.defineProperty(window,"ystorage",new function(){var g=[],a={};Object.defineProperty(a,"getItem",{value:function(c){return c?this[c]:null},writable:!1,configurable:!1,enumerable:!1});Object.defineProperty(a,"key",{value:function(c){return g[c]},writable:!1,configurable:!1,enumerable:!1});Object.defineProperty(a,"setItem",{value:function(c,a){c&&(document.cookie=escape(c)+"="+escape(a)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")},writable:!1,configurable:!1,enumerable:!1});
Object.defineProperty(a,"length",{get:function(){return g.length},configurable:!1,enumerable:!1});Object.defineProperty(a,"removeItem",{value:function(c){c&&(document.cookie=escape(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")},writable:!1,configurable:!1,enumerable:!1});this.get=function(){var c,e;for(e in a)c=g.indexOf(e),-1===c?a.setItem(e,a[e]):g.splice(c,1),delete a[e];for(;0<g.length;g.splice(0,1))a.removeItem(g[0]);for(var b=0,f=document.cookie.split(/\s*;\s*/);b<f.length;b++)c=f[b].split(/\s*=\s*/),
1<c.length&&(a[e=unescape(c[0])]=unescape(c[1]),g.push(e));return a};this.configurable=!1;this.enumerable=!0});
window.ySingleDb||(console.log("Creating ySingleDb ... "),window.ySingleDb=function(g){var a={_list:null,toBinArray:function(c){for(var a=(c||"").length,b=new Uint8Array(a),f=0;f<a;f++)b[f]=c.charCodeAt(f);return b},toBinString:function(c){c=new Uint8Array(c);for(var a=[],b=0;65535*b<c.length;b++)a.push(String.fromCharCode.apply(null,c.subarray(65535*b,65535*(b+1))));return a.join("")},setItem:function(c,e){c=String(c);e._id=generateUUID()||e._id;e._ts_update=(new Date).getTime()/1E3;localStorage.setItem(a._dbTag_+
"_item_"+c,JSON.stringify(e));-1==a._list.indexOf(c)&&(a._list[a._list.length]=c,localStorage.setItem(a._dbTag_+"_list",JSON.stringify(a._list)))},setBinItem:function(c,e){a.setItem(c,a.toBinString(e))},getItem:function(c){c=String(c);c=localStorage.getItem(a._dbTag_+"_item_"+c);return c=JSON.parse(c||"{}")},getBinItem:function(c){return a.toBinArray(a.getItem(c))},getList:function(){return a._list||[]},fillList:function(c,e,b){e=e||"id";b&&a.cleanList();for(b=0;b<c.length;b++)c[b][e]&&a.setItem(c[b][e],
c)},removeItem:function(c){if("function"==typeof a.onremove)a.onremove(a.getItem(c));localStorage.removeItem(a._dbTag_+"_item_"+c);c=a._list.indexOf(String(c));-1<c&&(a._list.splice(c,1),localStorage.setItem(a._dbTag_+"_list",JSON.stringify(a._list)))},cleanList:function(){for(var c in a._list)id=a._list[c],a.removeItem(id)},init:function(c){a._dbTag_=c;console.log("ystorage: creating "+c);a._list=localStorage.getItem(a._dbTag_+"_list");"string"==typeof a._list&&(a._list=JSON&&JSON.parse(a._list)||
[]);a._list=a._list||[];return a}};return a.init(g)},console.log("ystorage ready!"));
window.yServerWatcherObj||(window.yServerWatcherObj=function(g){var a={serverReady:function(c,a){var b=(new Date).getTime();ycomm.crave("sync","ping",null,function(f,n,d){200==f?0<parseInt(d.pong||0)&&(f=(new Date).getTime()-b,console.log("Server ready..."),console.log("Wasted time: {0}ms".format(f)),ycomm.wd_interval=4*f,"function"==typeof c&&c()):"function"==typeof a&&a(f,n)})},init:function(){ycomm.setDataLocation(g);a.serverReady(function(){console.log("Server ready!")});return a}};return a.init()});
window.yInfoObj||(window.yInfoObj=function(g,a,c,e){var b={};b.cfg={db:ySingleDb(a),garbage:ySingleDb(a+"_garbage"),dbName:a,keyName:c,dataModified:0,onrecordcount:null,onprogress:null,oncomplete:null};b.onremove=function(a){a._ts_deletion=(new Date).getTime()/1E3;b.cfg.garbage.setItem(a._id,a);b.cfg.dataModified++};b.isbusy=function(){return b.busy};b.getItem=function(a){return b.cfg.db.getItem(a)};b.setItem=function(a,c){b.cfg.dataModified++;return b.cfg.db.setItem(a,c)};b.removeItem=function(a){return b.cfg.db.removeItem(a)};
b.filter=function(a,c,d){if("function"==typeof a){c=yLexObj(d||!0);c.parse();var e=b.cfg.db.getList(),h,g;for(d=0;d<e.length;d++)h=b.cfg.db.getItem(e[d]),(g=c.solve(h))&&a(h)}};b.each=function(a,c,d){var e=function(b,a){a=String(a).split(" ");var c=!0,f,d;for(f in a)d=trim(a[f]),c=isNumber(d)&&isNumber(b)?c&&parseFloat(d)===parseFloat(b):c&&0<=(""+b).toUpperCase().indexOf(d.toUpperCase());return c},h,g=b.cfg.db.getList(),l,k;for(h=0;h<g.length;h++)if("function"==typeof a){l=b.cfg.db.getItem(g[h]);
k="undefined"==typeof d;if(!k)if("string"==typeof d)k=e(l[b.cfg.keyName],d);else if("object"==typeof d){k=!0;for(var m in d)d.hasOwnProperty(m)&&(k="undefined"!==typeof l[m]?k&&e(l[m],d[m]):!1)}k&&a(l)}"function"==typeof c&&c()};b.paint=b.each;b.count=function(a){var c=0;b.each(function(){c++},null,a);return c};b.extractData=function(a,c){var d=[];b.each(function(b){d[d.length]=b},function(){a(d)},c)};b.insertData=function(a){for(var c=0;c<a.length;c++)b.setItem(a[c][b.cfg.keyName],a[c])};b.cleanCondition=
function(){b.cfg.condition={}};b.setCondition=function(a){if("string"==typeof a){a=a.match(/\S+/g);var c,d="";for(c=0;c<a.length;c++)isNumber(a[c])||isOperator(a[c])||(a[c]="%("+a[c]+")"),d+=a[c]+" ";b.cfg.condition={_statement_:d}}else b.cfg.condition=a||{}};b._retrieveFromServer=function(){var a={xq_start:b.cfg.xq_start,xq_collectionName:b.cfg.dbName},c=(new Date).getTime();mergeObject(b.cfg.condition,a);ycomm.crave("sync","getDocumentInSequence",a,function(a,e,f){if(0<f.length){b.cfg.interleave.adjustRestTime(c);
for(a=0;a<f.length;a++)if(b.setItem(f[a][b.cfg.keyName],f[a]),"function"==typeof b.cfg.onprogress)b.cfg.onprogress(b.cfg.dbName,f[a],b.cfg.xq_start+a);b.cfg.xq_start+=f.length;setTimeout(b._retrieveFromServer,b.cfg.interleave.restTime)}else{if("function"==typeof b.cfg.oncomplete)b.cfg.oncomplete(b.cfg.dbName);b.busy=!1}})};b.retrieveFromServer=function(a,c,d){if(b.busy)return console.warn("yInfoObj busy"),!1;b.busy=!0;b.cfg.onrecordcount=a||null;b.cfg.oncomplete=c||null;b.cfg.onprogress=d||null;b.server.serverReady(function(){ycomm.crave("sync",
"getRecordCount",b.cfg.condition,function(a,c,d){d=d||[];d[0]=d[0]||{};if("function"==typeof b.cfg.onrecordcount)b.cfg.onrecordcount(b.cfg.dbName,parseInt(d[0].CC||0));b.cfg.xq_start=0;b._retrieveFromServer()})},function(b,a){console.log("Erro {0} ao tentar acessar o servidor: {1}".format(b,a.message))});return!0};b.templatedData=function(a){var c;if(b.cfg.dataTemplateEmpty)c=a;else{c={};for(var d in b.cfg.dataTemplate)b.cfg.dataTemplate.hasOwnProperty(d)&&(c[d]=a[d])}return c};b.sendToServer=function(a,
c){if(b.busy)return console.warn("yInfoObj busy"),!1;b.busy=!0;b.cfg.onrecordcount=null;b.cfg.oncomplete=a||null;b.cfg.onprogress=c||null;var d=0;b.server.serverReady(function(){b.each(function(a){var c=b.templatedData(a);a._ts_upload=(new Date(a)).getTime()/1E3;mergeObject(b.cfg.condition,c);ycomm.crave("sync","setDocument",c,function(a,c,e){if(200==a&&"function"==typeof b.cfg.onprogress)b.cfg.onprogress(b.cfg.dbName,e[0],++d)})},function(){if("function"==typeof b.cfg.oncomplete)b.cfg.oncomplete(b.cfg.dbName);
b.busy=!1},b.cfg.condition)},function(a,b){console.log("Erro {0} ao tentar acessar o servidor: {1}".format(a,b.message))});return!0};b.init=function(a){b.cfg.interleave=yRestTimeControl(500);b.cfg.dataTemplateEmpty="undefined"===typeof a?!0:!1;b.cfg.dataTemplate=a||{};b.cfg.db.onremove=b.onremove;b.server=yServerWatcherObj(g);b.cleanCondition();return b};return b.init(e)});
