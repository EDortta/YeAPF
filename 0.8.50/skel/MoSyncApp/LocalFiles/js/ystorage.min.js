/* YeAPF 0.8.50-9 built on 2016-08-23 14:51 (-3 DST) Copyright (C) 2004-2016 Esteban Daniel Dortta - dortta@yahoo.com */
window.ystorage||Object.defineProperty(window,"ystorage",new function(){var f=[],c={};Object.defineProperty(c,"getItem",{value:function(a){return a?this[a]:null},writable:!1,configurable:!1,enumerable:!1});Object.defineProperty(c,"key",{value:function(a){return f[a]},writable:!1,configurable:!1,enumerable:!1});Object.defineProperty(c,"setItem",{value:function(a,b){a&&(document.cookie=escape(a)+"="+escape(b)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")},writable:!1,configurable:!1,enumerable:!1});
Object.defineProperty(c,"length",{get:function(){return f.length},configurable:!1,enumerable:!1});Object.defineProperty(c,"removeItem",{value:function(a){a&&(document.cookie=escape(a)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")},writable:!1,configurable:!1,enumerable:!1});this.get=function(){var a,b;for(b in c)a=f.indexOf(b),-1===a?c.setItem(b,c[b]):f.splice(a,1),delete c[b];for(;0<f.length;f.splice(0,1))c.removeItem(f[0]);for(var d=0,g=document.cookie.split(/\s*;\s*/);d<g.length;d++)a=g[d].split(/\s*=\s*/),
1<a.length&&(c[b=unescape(a[0])]=unescape(a[1]),f.push(b));return c};this.configurable=!1;this.enumerable=!0});
window.ySingleDb||(console.log("Creating ySingleDb ... "),window.ySingleDb=function(f){var c={_list:null,toBinArray:function(a){for(var b=(a||"").length,d=new Uint8Array(b),g=0;g<b;g++)d[g]=a.charCodeAt(g);return d},toBinString:function(a){a=new Uint8Array(a);for(var b=[],d=0;65535*d<a.length;d++)b.push(String.fromCharCode.apply(null,a.subarray(65535*d,65535*(d+1))));return b.join("")},setItem:function(a,b){a=String(a);localStorage.setItem(c._dbTag_+"_item_"+a,JSON.stringify(b));-1==c._list.indexOf(a)&&
(c._list[c._list.length]=a,localStorage.setItem(c._dbTag_+"_list",JSON.stringify(c._list)))},setBinItem:function(a,b){c.setItem(a,c.toBinString(b))},getItem:function(a){a=String(a);a=localStorage.getItem(c._dbTag_+"_item_"+a);return a=JSON.parse(a||"{}")},getBinItem:function(a){return c.toBinArray(c.getItem(a))},getList:function(){return c._list||[]},fillList:function(a,b,d){b=b||"id";d&&c.cleanList();for(d=0;d<a.length;d++)a[d][b]&&c.setItem(a[d][b],a)},removeItem:function(a){localStorage.removeItem(c._dbTag_+
"_item_"+a);a=c._list.indexOf(String(a));-1<a&&(c._list.splice(a,1),localStorage.setItem(c._dbTag_+"_list",JSON.stringify(c._list)))},cleanList:function(){for(var a in c._list)id=c._list[a],c.removeItem(id)},init:function(a){c._dbTag_=a;console.log("ystorage: creating "+a);c._list=localStorage.getItem(c._dbTag_+"_list");"string"==typeof c._list&&(c._list=JSON&&JSON.parse(c._list)||[]);c._list=c._list||[];return c}};return c.init(f)},console.log("ystorage ready!"));
window.yServerWatcherObj||(window.yServerWatcherObj=function(f){var c={serverReady:function(a,b){var d=(new Date).getTime();ycomm.crave("sync","ping",null,function(g,c,h){200==g?0<parseInt(h.pong||0)&&(g=(new Date).getTime()-d,console.log("Server ready..."),console.log("Wasted time: {0}ms".format(g)),ycomm.wd_interval=4*g,"function"==typeof a&&a()):"function"==typeof b&&b(g,c)})},init:function(){ycomm.setDataLocation(f);c.serverReady(function(){console.log("Server ready!")});return c}};return c.init()});
window.yInfoObj||(window.yInfoObj=function(f,c,a){var b={};b.cfg={db:ySingleDb(c),dbName:c,keyName:a,onrecordcount:null,onprogress:null,oncomplete:null};b.isbusy=function(){return b.busy};b.getItem=function(a){return b.cfg.db.getItem(a)};b.setItem=function(a,c){return b.cfg.db.setItem(a,c)};b.removeItem=function(a){return b.cfg.db.removeItem(a)};b.filter=function(a,c,e){if("function"==typeof a){c=yLexObj(e||!0);c.parse();var h=b.cfg.db.getList(),n,f;for(e=0;e<h.length;e++)n=b.cfg.db.getItem(h[e]),
(f=c.solve(n))&&a(n)}};b.each=function(a,c,e){var h=function(b,a){a=String(a).split(" ");var c=!0,d,g;for(d in a)g=trim(a[d]),c=isNumber(g)&&isNumber(b)?c&&parseFloat(g)===parseFloat(b):c&&0<=b.toUpperCase().indexOf(g.toUpperCase());return c},f,p=b.cfg.db.getList(),l,k;for(f=0;f<p.length;f++)if("function"==typeof a){l=b.cfg.db.getItem(p[f]);k="undefined"==typeof e;if(!k)if("string"==typeof e)k=h(l[b.cfg.keyName],e);else if("object"==typeof e){k=!0;for(var m in e)e.hasOwnProperty(m)&&(k="undefined"!==
typeof l[m]?k&&h(l[m],e[m]):!1)}k&&a(l)}"function"==typeof c&&c()};b.paint=b.each;b.count=function(a){var c=0;b.each(function(){c++},null,a);return c};b.extractData=function(a,c){var e=[];b.each(function(b){e[e.length]=b},function(){a(e)},c)};b.insertData=function(a){for(var c=0;c<a.length;c++)b.setItem(a[c][b.cfg.keyName],a[c])};b.cleanCondition=function(){b.cfg.condition={}};b.setCondition=function(a){if("string"==typeof a){a=a.match(/\S+/g);var c,e="";for(c=0;c<a.length;c++)isNumber(a[c])||isOperator(a[c])||
(a[c]="%("+a[c]+")"),e+=a[c]+" ";b.cfg.condition={_statement_:e}}else b.cfg.condition=a||{}};b._retrieveFromServer=function(){var a={xq_start:b.cfg.xq_start};mergeObject(b.cfg.condition,a);ycomm.crave("sync","getRecordInfo_"+b.cfg.dbName,a,function(a,c,h){if(0<h.length){for(a=0;a<h.length;a++)if(b.setItem(h[a][b.cfg.keyName],h[a]),"function"==typeof b.cfg.onprogress)b.cfg.onprogress(b.cfg.dbName,h[a],b.cfg.xq_start+a);b.cfg.xq_start+=h.length;setTimeout(b._retrieveFromServer,500)}else{if("function"==
typeof b.cfg.oncomplete)b.cfg.oncomplete(b.cfg.dbName);b.busy=!1}})};b.retrieveFromServer=function(a,c,e){if(b.busy)return console.warn("yInfoObj busy"),!1;b.busy=!0;b.cfg.onrecordcount=a||null;b.cfg.oncomplete=c||null;b.cfg.onprogress=e||null;b.server.serverReady(function(){ycomm.crave("sync","getRecordCount_"+b.cfg.dbName,b.cfg.condition,function(a,c,d){d=d||[];d[0]=d[0]||{};if("function"==typeof b.cfg.onrecordcount)b.cfg.onrecordcount(b.cfg.dbName,parseInt(d[0].CC||0));b.cfg.xq_start=0;b._retrieveFromServer()})},
function(b,a){console.log("Erro {0} ao tentar acessar o servidor: {1}".format(b,a.message))});return!0};b.sendToServer=function(a,c){if(b.busy)return console.warn("yInfoObj busy"),!1;b.busy=!0;b.cfg.onrecordcount=null;b.cfg.oncomplete=a||null;b.cfg.onprogress=c||null;var e=0;b.server.serverReady(function(){b.each(function(a){a={ID:a.ID,LATITUDE:a.LATITUDE,LONGITUDE:a.LONGITUDE,ACCURACY:a.ACCURACY,last_change:a.last_change,device:y$("deviceUUID").innerHTML};mergeObject(b.cfg.condition,a);ycomm.crave("sync",
"setRecordInfo_"+b.cfg.dbName,a,function(a,c,d){if(200==a&&"function"==typeof b.cfg.onprogress)b.cfg.onprogress(b.cfg.dbName,d[0],++e)})},function(){if("function"==typeof b.cfg.oncomplete)b.cfg.oncomplete(b.cfg.dbName);b.busy=!1},b.cfg.condition)},function(a,b){console.log("Erro {0} ao tentar acessar o servidor: {1}".format(a,b.message))});return!0};b.init=function(){b.server=yServerWatcherObj(f);b.cleanCondition();return b};return b.init()});
